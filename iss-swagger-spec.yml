openapi: 3.0.3
info:
  title: Inženjerstvo serverskog sloja - projekat 2022
  version: 1.1.4
tags:
  - name: passenger
    description: Passenger functionalities
  - name: driver
    description: Driver functionalities
  - name: ride
    description: Ride functionalities
  - name: review
    description: Review functionalities
  - name: panic
    description: Panic functionalities
  - name: vehicle
    description: Vehicle functionalities
  - name: user
    description: User functionalities
  - name: unregistered user
    description: Unregistered user functionalities
paths:
  /api/passenger:
    post:
      tags:
        - passenger
      summary: Create passenger
      description: Create new passenger
      operationId: createPassenger
      requestBody:
        $ref: "#/components/requestBodies/CreateUser"
      responses:
        "200":
          description: ""
          content:
            application/json:
              schema:
                allOf:
                  - type: object
                    properties:
                      id:
                        type: integer
                        format: integer
                        example: 123
                  - $ref: "#/components/schemas/User"
        "400":
          description: Invalid data. For example invalid id or email, or email already exists etc.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
    get:
      tags:
        - passenger
      summary: Getting passengers
      description: Getting multiple passengers for the need of showing a list
      operationId: gettingPassengers
      parameters:
        - in: query
          name: page
          schema:
            type: integer
          description: Which page
        - in: query
          name: size
          schema:
            type: integer
          description: How many elements on page
      responses:
        "200":
          description: ""
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/PaginatedResponse"
                  - type: object
                    properties:
                      results:
                        type: array
                        items:
                          allOf:
                            - type: object
                              properties:
                                id:
                                  type: integer
                                  format: integer
                                  example: 10
                            - $ref: "#/components/schemas/User"
  /api/passenger/{activationId}:
    post:
      tags:
        - passenger
      summary: Activate passenger account
      description: Activating passenger with the activation email
      operationId: activatePassenger
      parameters:
        - name: activationId
          in: path
          description: Id of the passenger
          required: true
          schema:
            type: integer
      responses:
        "200":
          description: Successful account activation
        "400":
          description: Invalid data, for example the activation time has expired or error while hash calculation
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Activation does not exist
  /api/passenger/{id}:
    get:
      tags:
        - passenger
      summary: Passenger details
      description: Returns passenger details, where the password field is always empty
      operationId: passengerDetails
      parameters:
        - name: id
          in: path
          description: Id of the passenger
          required: true
          schema:
            type: integer
      responses:
        "200":
          $ref: "#/components/requestBodies/UserDetails"
        "400":
          description: Invalid data, for example bad id
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Passenger does not exist
    put:
      tags:
        - passenger
      summary: Update existing passenger
      description: Update existing passenger non required filed send only if the change
      operationId: updatePassenger
      parameters:
        - name: id
          in: path
          description: Id of the passenger
          required: true
          schema:
            type: integer
      requestBody:
        $ref: "#/components/requestBodies/CreateUser"
        required: true
      responses:
        "200":
          $ref: "#/components/requestBodies/UserDetails"
        "400":
          description: Invalid data. For example bad email format.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Passenger does not exist
  /api/passenger/{id}/ride:
    get:
      tags:
        - passenger
      summary: Passenger rides
      description: Returns paginated rides that can be sorted on specific field
      operationId: voznjePutnika
      parameters:
        - name: id
          in: path
          description: ID putnika
          required: true
          schema:
            type: integer
        - in: query
          name: page
          schema:
            type: number
            format: number
          description: Which page
        - in: query
          name: size
          schema:
            type: number
            format: number
          description: how many elements on page
        - in: query
          name: sort
          schema:
            type: string
            format: string
            example: firstName
        - in: query
          name: from
          schema:
            type: string
            format: date-time
          description: Početak intervala
        - in: query
          name: to
          schema:
            type: string
            format: date-time
          description: Kraj intervala
      responses:
        "200":
          description: ""
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/PaginatedResponse"
                  - type: object
                    properties:
                      results:
                        type: array
                        items:
                          allOf:
                            - type: object
                              properties:
                                id:
                                  type: integer
                                  format: integer
                                  example: 10
                                locations:
                                  type: array
                                  items:
                                    $ref: "#/components/schemas/GeoCoordinate"
                            - $ref: "#/components/schemas/Ride"
        "400":
          description: Invalid data. For example bad Id format.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Passenger does not exist

  /api/driver:
    post:
      tags:
        - driver
      summary: Create driver
      description: Create new driver
      operationId: createDriver
      requestBody:
        $ref: "#/components/requestBodies/CreateUser"
      responses:
        "200":
          description: ""
          content:
            application/json:
              schema:
                allOf:
                  - type: object
                    properties:
                      id:
                        type: integer
                        format: integer
                        example: 123
                  - $ref: "#/components/schemas/User"
        "400":
          description: Invalid data. For example invalid id or email, or email already exists etc.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
    get:
      tags:
        - driver
      summary: Getting paginated driver data
      description: Returns paginated drivers
      operationId: gettingDrivers
      parameters:
        - in: query
          name: page
          schema:
            type: integer
          description: Which page
        - in: query
          name: size
          schema:
            type: integer
          description: How meni elements from it
      responses:
        "200":
          description: ""
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/PaginatedResponse"
                  - type: object
                    properties:
                      results:
                        type: array
                        items:
                          allOf:
                            - type: object
                              properties:
                                id:
                                  type: integer
                                  format: integer
                                  example: 10
                            - $ref: "#/components/schemas/User"
  /api/driver/{id}:
    get:
      tags:
        - driver
      summary: Driver details
      description: Returns details about the driver
      operationId: driverDetails
      parameters:
        - name: id
          in: path
          description: ID of the driver
          required: true
          schema:
            type: integer
      responses:
        "200":
          $ref: "#/components/requestBodies/UserDetails"
        "400":
          description: Invalid data. For example bad Id format.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Driver does not exist.
    put:
      tags:
        - driver
      summary: Update existing driver
      description: Update the existing driver based on his id
      operationId: updateDriver
      parameters:
        - name: id
          in: path
          description: ID vozača
          required: true
          schema:
            type: integer
      requestBody:
        $ref: "#/components/requestBodies/UserDetails"
        required: true
      responses:
        "200":
          $ref: "#/components/requestBodies/UserDetails"
        "400":
          description: Invalid data. For example bad email format.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Driver does not exist.
  /api/driver/{id}/documents:
    get:
      tags:
        - driver
      summary: Driver documents
      description: Returns all documents with the specific id
      operationId: driverDocuments
      parameters:
        - name: id
          in: path
          description: Id of the driver
          required: true
          schema:
            type: integer
      responses:
        "200":
          description: ""
          content:
            application/json:
              schema:
                type: array
                items:
                  allOf:
                    - type: object
                      properties:
                        id:
                          type: integer
                          format: integer
                          example: 123
                    - $ref: "#/components/schemas/DriverDocument"
        "400":
          description: Invalid data. For example bad Id format.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Driver does not exist
    delete:
      tags:
        - driver
      summary: Deleting drivers documents
      description: Deleting drivers documents
      operationId: deletingDriversDocuments
      parameters:
        - name: id
          in: path
          description: Id of the driver
          required: true
          schema:
            type: integer
      responses:
        "204":
          description: Driver deleted successfully
        "400":
          description: Invalid data. For example bad Id format.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Driver does not exist.
    post:
      tags:
        - driver
      summary: Adding new driver documents
      description: Adding new driver document (for example a picture)
      operationId: addDriverDocument
      parameters:
        - name: id
          in: path
          description: Id of the driver
          required: true
          schema:
            type: integer
      requestBody:
        $ref: "#/components/requestBodies/DriverDocument"
      responses:
        "200":
          description: ""
          content:
            application/json:
              schema:
                allOf:
                  - type: object
                    properties:
                      id:
                        type: integer
                        format: integer
                        example: 123
                  - $ref: "#/components/schemas/DriverDocument"
        "400":
          description: Invalid data. For example bad Id format.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Driver does not exist
  /api/driver/{id}/vehicle:
    get:
      tags:
        - driver
      summary: Vehicle of the driver
      description: Returns vehicle for the driver
      operationId: driversVehicle
      parameters:
        - name: id
          in: path
          description: Id of the driver
          required: true
          schema:
            type: integer
      responses:
        "200":
          description: ""
          content:
            application/json:
              schema:
                allOf:
                  - type: object
                    properties:
                      id:
                        type: integer
                        format: integer
                        example: 123
                      driverId:
                        type: integer
                        format: integer
                        example: 123
                  - $ref: "#/components/schemas/Vehicle"
        "400":
          description: Invalid data. For example bad Id format.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Vehicle or driver do not exist
    post:
      tags:
        - driver
      summary: Add vehicle to the driver
      description: Creating a new vehicle to the driver while creating one if it does not exist
      operationId: createVehicle
      parameters:
        - name: id
          in: path
          description: Id of the driver
          required: true
          schema:
            type: integer
      requestBody:
        content:
          application/json:
            schema:
              allOf:
                - $ref: "#/components/schemas/Vehicle"
      responses:
        "200":
          description: ""
          content:
            application/json:
              schema:
                allOf:
                  - type: object
                    properties:
                      id:
                        type: integer
                        format: integer
                        example: 123
                      driverId:
                        type: integer
                        format: integer
                        example: 123
                  - $ref: "#/components/schemas/Vehicle"
        "400":
          description: Invalid data. For example bad Id format.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Driver does not exist
    put:
      tags:
        - driver
      summary: Change the vehicle of the driver
      description: Change the vehicle of the driver
      operationId: changeVehicle
      parameters:
        - name: id
          in: path
          description: Id of the driver
          required: true
          schema:
            type: integer
      requestBody:
        content:
          application/json:
            schema:
              allOf:
                - $ref: "#/components/schemas/Vehicle"
      responses:
        "200":
          description: ""
          content:
            application/json:
              schema:
                allOf:
                  - type: object
                    properties:
                      id:
                        type: integer
                        format: integer
                        example: 123
                      driverId:
                        type: integer
                        format: integer
                        example: 123
                  - $ref: "#/components/schemas/Vehicle"
        "400":
          description: Invalid data. For example bad Id format.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Driver does not exist

  /api/driver/{id}/working-hours:
    get:
      tags:
        - driver
      summary: Working hours of the driver
      description: Returns history of the drivers working hours where it can be filtered by date
      operationId: workingHoursOverview
      parameters:
        - name: id
          in: path
          description: Id of the driver
          required: true
          schema:
            type: integer
        - in: query
          name: page
          schema:
            type: number
            format: number
          description: Which page to retrieve
        - in: query
          name: size
          schema:
            type: number
            format: number
          description: How many items to retrieve
        - in: query
          name: from
          schema:
            type: string
            format: date-time
          description: Start of the interval
        - in: query
          name: to
          schema:
            type: string
            format: date-time
          description: End of the interval
      responses:
        "200":
          description: ""
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/PaginatedResponse"
                  - type: object
                    properties:
                      results:
                        type: array
                        items:
                          $ref: "#/components/schemas/WorkingHour"
        "400":
          description: Invalid data. For example bad Id format.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Driver does not exist
    post:
      tags:
        - driver
      summary: Creating informations about the drivers working hours
      description: Creating informations about the drivers working hours
      operationId: createWorkingHours
      parameters:
        - name: id
          in: path
          description: Id of the driver
          required: true
          schema:
            type: integer
      responses:
        "200":
          description: ""
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/WorkingHour"
        "400":
          description: Invalid data. For example bad Id format.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Driver does not exist

  /api/driver/{id}/ride:
    get:
      tags:
        - driver
      summary: Rides of the specific driver
      description: Returning rides for the driver that can be sorted by specific fields
      operationId: driversRides
      parameters:
        - name: id
          in: path
          description: Id of the driver
          required: true
          schema:
            type: integer
        - in: query
          name: page
          schema:
            type: integer
            format: integer
            example: 2
        - in: query
          name: size
          schema:
            type: integer
            format: integer
            example: 10
        - in: query
          name: sort
          schema:
            type: string
            format: string
            example: startTime
        - in: query
          name: from
          schema:
            type: string
            format: date-time
          description: Start of the interval
        - in: query
          name: to
          schema:
            type: string
            format: date-time
          description: End of the interval
      responses:
        "200":
          description: ""
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/PaginatedResponse"
                  - type: object
                    properties:
                      results:
                        type: array
                        items:
                          allOf:
                            - type: object
                              properties:
                                id:
                                  type: integer
                                  format: integer
                                  example: 10
                                locations:
                                  type: array
                                  items:
                                    $ref: "#/components/schemas/GeoCoordinate"
                                rejection:
                                  type: object
                                  properties:
                                    reason:
                                      type: string
                                      format: string
                                      example: Ride is canceled due to previous problems with the passenger
                                    timeOfRejection:
                                      type: string
                                      format: date-time
                                      example: 2022-11-25T17:32:28Z
                            - $ref: "#/components/schemas/Ride"
        "400":
          description: Invalid data. For example bad Id format.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Driver does not exist

  /api/driver/{driver-id}/working-hour/{working-hour-id}:
    get:
      tags:
        - driver
      summary: Detais about the working hours of the driver
      description: Returns details about the individual working hours of the driver
      operationId: workingHourDetails
      parameters:
        - name: driver-id
          in: path
          description: Id of the driver
          required: true
          schema:
            type: integer
        - name: working-hour-id
          in: path
          description: Id of the working hour
          required: true
          schema:
            type: integer
      responses:
        "200":
          description: ""
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/WorkingHour"
        "400":
          description: Invalid data. For example bad Id format.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Driver does not exist or the Working hours does not exist
    put:
      tags:
        - driver
      summary: Changing the working hours
      description: Changing individual working hours of the driver
      operationId: changingWorkingHours
      parameters:
        - name: driver-id
          in: path
          description: Id of the driver
          required: true
          schema:
            type: integer
        - name: working-hour-id
          in: path
          description: Id of the working hour
          required: true
          schema:
            type: integer
      responses:
        "200":
          description: ""
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/WorkingHour"
        "400":
          description: Invalid data. For example bad Id format.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Driver does not exist or working hours do not exist

  /api/ride:
    post:
      tags:
        - ride
      summary: Creating a ride
      description: Creating a ride
      operationId: creatingRide
      requestBody:
        $ref: "#/components/requestBodies/RideCreation"
        required: true
      responses:
        "200":
          description: ""
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/Ride"
                  - type: object
                    properties:
                      status:
                        type: string
                        format: string
                        example: Pending
        "400":
          description: Invalid data. For example the date is in the wrong format.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
  /api/ride/active/{driverId}:
    get:
      tags:
        - ride
      summary: Active ride for driver
      description: Return active ride details for the driver
      operationId: activeRideDriverDetails
      parameters:
        - name: driverId
          in: path
          required: true
          schema:
            type: integer
          description: Which driver
      responses:
        "200":
          description: ""
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/Ride"
                  - type: object
                    properties:
                      status:
                        type: string
                        format: string
                        example: Pending
        "404":
          description: Active ride does not exist
  /api/ride/active/{passengerId}:
    get:
      tags:
        - ride
      summary: Active ride for passenger
      description: Return active ride details for the passenger
      operationId: activeRidePassengerDetails
      parameters:
        - name: passengerId
          in: path
          required: true
          schema:
            type: integer
          description: Which driver
      responses:
        "200":
          description: ""
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/Ride"
                  - type: object
                    properties:
                      status:
                        type: string
                        format: string
                        example: Pending
        "404":
          description: Active ride does not exist
  /api/ride/{id}:
    get:
      tags:
        - ride
      summary: Ride details
      description: Return ride details with the specific id
      operationId: rideDetails
      parameters:
        - name: id
          in: path
          description: Id of the ride
          required: true
          schema:
            type: integer
      responses:
        "200":
          description: ""
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/Ride"
                  - type: object
                    properties:
                      status:
                        type: string
                        format: string
                        example: Pending
                      rejection:
                        type: object
                        properties:
                          reason:
                            type: string
                            format: string
                            example: Ride is canceled due to previous problems with the passenger
                          timeOfRejection:
                            type: string
                            format: date-time
                            example: 2022-11-25T17:32:28Z
        "400":
          description: Invalid data. For example bad Id format.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Ride does not exist
    put:
      tags:
        - ride
      summary: Cancel existing ride
      description: The passenger should have the possibility to cancel an existing ride if he changed his mind before the driver has arrived at the destination
      operationId: cancelRide
      parameters:
        - name: id
          in: path
          description: Id of the ride
          required: true
          schema:
            type: integer
      responses:
        "204":
          description: Ride successfully canceled
        "400":
          description: Invalid data. For example bad Id format.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Ride does not exist

  /api/ride/{id}/panic:
    put:
      tags:
        - ride
      summary: Panic procedure for the ride
      description: Panic procedure for the ride by id. The user will be used from the token (later when we get to security)
      operationId: ridePanic
      parameters:
        - name: id
          in: path
          description: Id of the ride
          required: true
          schema:
            type: integer
      requestBody:
        $ref: "#/components/requestBodies/PanicCreate"
        required: true
      responses:
        "200":
          description: ""
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PanicDetails"
        "400":
          description: Invalid data. For example bad Id format.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Ride does not exist

  /api/ride/{id}/accept:
    put:
      tags:
        - ride
      summary: Accept ride
      description: Accept ride
      operationId: rideAccept
      parameters:
        - name: id
          in: path
          description: Id of the ride
          required: true
          schema:
            type: integer
      responses:
        "200":
          description: ""
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/Ride"
                  - type: object
                    properties:
                      status:
                        type: string
                        format: string
                        example: ACCEPTED
        "400":
          description: Invalid data. For example bad Id format.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Ride does not exist

  /api/ride/{id}/end:
    put:
      tags:
        - ride
      summary: End the ride
      description: End the ride
      operationId: rideEnd
      parameters:
        - name: id
          in: path
          description: Id of the ride
          required: true
          schema:
            type: integer
      responses:
        "200":
          description: ""
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/Ride"
                  - type: object
                    properties:
                      status:
                        type: string
                        format: string
                        example: FINISHED
        "400":
          description: Invalid data. For example bad Id format.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Ride does not exist

  /api/ride/{id}/cancel:
    put:
      tags:
        - ride
      summary: Cancel the ride with an explanation
      description: Cancel the ride with an explanation
      operationId: rideCancel
      parameters:
        - name: id
          in: path
          description: Id of the ride
          required: true
          schema:
            type: integer
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required:
                - reason
              properties:
                reason:
                  type: string
                  format: string
                  example: No passengers were at the destination
                  maxLength: 500
      responses:
        "200":
          description: ""
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/Ride"
                  - type: object
                    properties:
                      status:
                        type: string
                        format: string
                        example: REJECTED
        "400":
          description: Invalid data. For example bad Id format.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Ride does not exist

  /api/panic:
    get:
      tags:
        - panic
      summary: Overview of all panic notifications
      description: Overview of all panic notifications
      operationId: overviewPanic
      responses:
        "200":
          description: ""
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/PaginatedResponse"
                  - type: object
                    properties:
                      results:
                        type: array
                        items:
                          type: object
                          properties:
                            id:
                              type: integer
                              format: integer
                              example: 10
                            user:
                              $ref: "#/components/schemas/User"
                            ride:
                              $ref: "#/components/schemas/Ride"
                            time:
                              type: string
                              format: date-time
                            reason:
                              type: string
                              example: Driver is drinking while driving

  /api/vehicle/{id}/location:
    put:
      tags:
        - vehicle
      summary: Change location of the vehicle
      description: Change the location of the vehicle. It is different from the main change as it updates only the location at the idea is that if works for frequent changes
      operationId: changeLocationVehicle
      parameters:
        - name: id
          in: path
          description: Id of the vehicle
          required: true
          schema:
            type: integer
      requestBody:
        $ref: "#/components/requestBodies/GeoCoordinate"
        required: true
      responses:
        "204":
          description: Coordinates successfully updated
        "400":
          description: Invalid data. For example bad Id format.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Vehicle does not exist

  /api/user/{id}/ride:
    get:
      tags:
        - user
      summary: Rides of the user
      description: Returns paginated response of rides for a user that can be sorted by a specific field
      operationId: voznjeKorisnika
      parameters:
        - name: id
          in: path
          description: Id of user
          required: true
          schema:
            type: integer
        - in: query
          name: page
          schema:
            type: integer
            format: integer
            example: 2
        - in: query
          name: size
          schema:
            type: integer
            format: integer
            example: 2
        - in: query
          name: sort
          schema:
            type: string
            format: string
            example: startTime
        - in: query
          name: from
          schema:
            type: string
            format: date-time
          description: Start of the interval
        - in: query
          name: to
          schema:
            type: string
            format: date-time
          description: End of the interval
      responses:
        "200":
          description: ""
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/PaginatedResponse"
                  - type: object
                    properties:
                      results:
                        type: array
                        items:
                          allOf:
                            - type: object
                              properties:
                                id:
                                  type: integer
                                  format: integer
                                  example: 10
                                locations:
                                  type: array
                                  items:
                                    $ref: "#/components/schemas/GeoCoordinate"
                            - $ref: "#/components/schemas/Ride"
        "400":
          description: Invalid data. For example bad Id format.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: User does not exist
  /api/user:
    get:
      tags:
        - user
      summary: Getting user details
      description: Getting multiple of them for the reason of showing a list
      operationId: gettingUsers
      parameters:
        - in: query
          name: page
          schema:
            type: integer
          description: Which exact page
        - in: query
          name: size
          schema:
            type: integer
          description: How many elements
      responses:
        "200":
          description: ""
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/PaginatedResponse"
                  - type: object
                    properties:
                      results:
                        type: array
                        items:
                          allOf:
                            - type: object
                              properties:
                                id:
                                  type: integer
                                  format: integer
                                  example: 10
                            - $ref: "#/components/schemas/User"
  /api/login:
    post:
      tags:
        - user
      summary: Log in
      description: Login
      operationId: login
      requestBody:
        $ref: "#/components/requestBodies/Login"
      responses:
        "200":
          description: ""
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/TokenResponse"
        "400":
          description: Invalid data. For example the user with the email does not exist or the password does not match
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
  /api/user/{id}/message:
    get:
      tags:
        - user
      summary: User messages
      description: Returns a list of user messages
      operationId: listaPoruka
      parameters:
        - name: id
          in: path
          description: Id of the user
          required: true
          schema:
            type: integer
      responses:
        "200":
          description: ""
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/PaginatedResponse"
                  - type: object
                    properties:
                      results:
                        type: array
                        items:
                          allOf:
                            - type: object
                              properties:
                                id:
                                  type: integer
                                  format: integer
                                  example: 10
                                timeOfSending:
                                  type: string
                                  format: date-time
                                  example: 2022-11-25T17:32:28Z
                                senderId:
                                  type: number
                                  format: number
                                  example: 123
                            - $ref: "#/components/schemas/Message"
        "400":
          description: Invalid data. For example bad Id format.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: User does not exist
    post:
      tags:
        - user
      summary: Send a message to the user
      description: Send a message to the user. The sender is taken from the user that sent the request (from the token)
      operationId: newMessage
      parameters:
        - name: id
          in: path
          description: Id of the user
          required: true
          schema:
            type: integer
      requestBody:
        $ref: "#/components/requestBodies/Message"
      responses:
        "200":
          description: ""
          content:
            application/json:
              schema:
                allOf:
                  - type: object
                    properties:
                      id:
                        type: integer
                        example: 123
                      timeOfSending:
                        type: string
                        format: date-time
                        example: 2022-11-25T17:32:28Z
                      senderId:
                        type: number
                        format: number
                        example: 123
                  - $ref: "#/components/schemas/Message"
        "400":
          description: Invalid data. For example bad Id format.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: User does not exist
  /api/user/{id}/block:
    put:
      tags:
        - user
      summary: Blocking of the user
      description: Blocking the user from the part of the administrator
      operationId: userBlocking
      parameters:
        - name: id
          in: path
          description: Id of the user
          required: true
          schema:
            type: integer
      responses:
        "204":
          description: User is successfully blocked
        "400":
          description: Invalid data. For example bad Id format.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: User does not exist
  /api/user/{id}/unblock:
    put:
      tags:
        - user
      summary: Unblocking user
      description: Unblocking user from the administrator
      operationId: userUnblocking
      parameters:
        - name: id
          in: path
          description: Id of the user
          required: true
          schema:
            type: integer
      responses:
        "204":
          description: User is successfully unblocked
        "400":
          description: Invalid data. For example bad Id format.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: User does not exist
  /api/user/{id}/note:
    post:
      tags:
        - user
      summary: Note creating
      description: Creaiting note form the part of the administrator, where they can help about ban decisions
      operationId: noteCreating
      requestBody:
        $ref: "#/components/requestBodies/Note"
      parameters:
        - name: id
          in: path
          description: Id of the user
          required: true
          schema:
            type: integer
      responses:
        "200":
          description: ""
          content:
            application/json:
              schema:
                allOf:
                  - type: object
                    properties:
                      id:
                        type: integer
                        format: integer
                        example: 10
                      date:
                        type: string
                        format: date-time
                        example: 2022-11-25T17:32:28Z
                  - $ref: "#/components/schemas/Note"
        "400":
          description: Invalid data. For example bad Id format.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: User does not exist
    get:
      tags:
        - user
      summary: Getting notes for the user
      description: For a specific user get the paginated response that will return the coresponding notes
      operationId: gettingNotes
      parameters:
        - name: id
          in: path
          description: Id from the user
          required: true
          schema:
            type: integer
        - in: query
          name: page
          schema:
            type: integer
          description: Which exact page
        - in: query
          name: size
          schema:
            type: integer
          description: How many elements on it
      responses:
        "200":
          description: ""
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/PaginatedResponse"
                  - type: object
                    properties:
                      results:
                        type: array
                        items:
                          allOf:
                            - type: object
                              properties:
                                id:
                                  type: integer
                                  format: integer
                                  example: 10
                                date:
                                  type: string
                                  format: date-time
                                  example: 2022-11-25T17:32:28Z
                            - $ref: "#/components/schemas/Note"
        "400":
          description: Invalid data. For example bad Id format.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: User does not exist
  /api/unregisteredUser/:
    post:
      tags:
        - unregistered user
      summary: Getting the assumption about the time and cost of the ride
      description: Getting the assumption about the time and cost of the ride
      operationId: timeAndCostAssumption
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/DrivingAssessment"
      responses:
        "200":
          description: ""
          content:
            application/json:
              schema:
                type: object
                properties:
                  estimatedTimeInMinutes:
                    type: integer
                    format: integer
                    example: 10
                  estimatedCost:
                    type: integer
                    format: integer
                    example: 450
        "400":
          description: Invalid data. For example bad Id format.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /api/review/vehicle/{id}:
    post:
      tags:
        - review
      summary: Leave review for the vehicle
      description: Creating a review about the vehicle
      operationId: reviewCreationForVehicle
      parameters:
        - name: id
          in: path
          description: Id of the vehicle
          required: true
          schema:
            type: integer
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required:
                - rating
                - comment
              properties:
                rating:
                  type: integer
                  format: integer
                  example: 3
                  minimum: 1
                  maximum: 10
                comment:
                  type: string
                  format: string
                  example: The vehicle was bad and dirty
                  maxLength: 500
      responses:
        "200":
          description: ""
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: integer
                    format: integer
                    example: 123
                  rating:
                    type: integer
                    format: integer
                    example: 3
                    minimum: 1
                    maximum: 10
                  comment:
                    type: string
                    format: string
                    example: The driver was driving really fast
                    maxLength: 500
        "400":
          description: Invalid data or it is not possible to create a review
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Ride does not exist
    get:
      tags:
        - review
      summary: Getting the reviews for the vehicle
      description: Get the reviews for the specific vehicle
      operationId: gettingTheReviewForVehicle
      parameters:
        - name: id
          in: path
          description: Id of the vehicle
          required: true
          schema:
            type: integer
      responses:
        "200":
          description: ""
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/PaginatedResponse"
                  - type: object
                    properties:
                      results:
                        type: array
                        items:
                          type: object
                          properties:
                            id:
                              type: integer
                              format: integer
                              example: 123
                            rating:
                              type: integer
                              format: integer
                              example: 3
                              minimum: 1
                              maximum: 10
                            comment:
                              type: string
                              format: string
                              example: The driver was driving too fast
                              maxLength: 500

  /api/review/driver/{id}:
    post:
      tags:
        - review
      summary: Leave review for the driver
      description: Creating a review about the driver
      operationId: reviewCreation
      parameters:
        - name: id
          in: path
          description: Id of the driver
          required: true
          schema:
            type: integer
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required:
                - rating
                - comment
              properties:
                rating:
                  type: integer
                  format: integer
                  example: 3
                  minimum: 1
                  maximum: 10
                comment:
                  type: string
                  format: string
                  example: The driver was driving really fast
                  maxLength: 500
      responses:
        "200":
          description: ""
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: integer
                    format: integer
                    example: 123
                  rating:
                    type: integer
                    format: integer
                    example: 3
                    minimum: 1
                    maximum: 10
                  comment:
                    type: string
                    format: string
                    example: The driver was driving really fast
                    maxLength: 500
        "400":
          description: Invalid data or it is not possible to create a review
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Ride does not exist
    get:
      tags:
        - review
      summary: Getting the reviews for the driver
      description: Get the reviews for the specific driver
      operationId: gettingTheReview
      parameters:
        - name: id
          in: path
          description: Id of the ride
          required: true
          schema:
            type: integer
      responses:
        "200":
          description: ""
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/PaginatedResponse"
                  - type: object
                    properties:
                      results:
                        type: array
                        items:
                          type: object
                          properties:
                            id:
                              type: integer
                              format: integer
                              example: 123
                            rating:
                              type: integer
                              format: integer
                              example: 3
                              minimum: 1
                              maximum: 10
                            comment:
                              type: string
                              format: string
                              example: The driver was driving too fast
                              maxLength: 500

  /api/review/{rideId}:
    get:
      tags:
        - review
      summary: Getting all reviews for the specific ride
      description: Overview of both reviews for the specific ride (driver and vehicle)
      operationId: gettingReviewsForRide
      parameters:
        - in: path
          name: rideId
          description: Id of the ride
          required: true
          schema:
            type: integer
      responses:
        "200":
          description: ""
          content:
            application/json:
              schema:
                type: object
                properties:
                  vehicleReview:
                    type: object
                    properties:
                      id:
                        type: integer
                        format: integer
                        example: 123
                      rating:
                        type: integer
                        format: integer
                        example: 3
                        minimum: 1
                        maximum: 10
                      comment:
                        type: string
                        format: string
                        example: The vehicle was bad and dirty
                        maxLength: 500
                  driverReview:
                    type: object
                    properties:
                      id:
                        type: integer
                        format: integer
                        example: 123
                      rating:
                        type: integer
                        format: integer
                        example: 3
                        minimum: 1
                        maximum: 10
                      comment:
                        type: string
                        format: string
                        example: The driver was driving too fast
                        maxLength: 500

components:
  schemas:
    TokenResponse:
      type: object
      properties:
        accessToken:
          type: string
          example: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c
        refreshToken:
          type: string
          example: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c
    PaginatedResponse:
      type: object
      properties:
        totalCount:
          type: integer
          format: integer
          example: 243
    UserRef:
      type: object
      properties:
        id:
          type: integer
          format: integer
          example: 123
        email:
          type: string
          format: email
        type:
          type: string
          example: DRIVER
    Error:
      type: object
      properties:
        poruka:
          type: string
          example: For example a wrong format of some field in the request
    User:
      type: object
      properties:
        name:
          type: string
          example: Pera
          maxLength: 100
        surname:
          type: string
          example: Perić
          maxLength: 100
        profilePicture:
          type: string
          format: byte
          example: U3dhZ2dlciByb2Nrcw==
        telephoneNumber:
          type: string
          example: "+381123123"
          maxLength: 18
        email:
          type: string
          format: email
          example: pera.peric@email.com
        address:
          type: string
          example: Bulevar Oslobodjenja 74
          maxLength: 100
    DriverDocument:
      type: object
      required:
        - name
        - documentImage
        - driverId
      properties:
        name:
          type: string
          example: Vozačka dozvola
          maxLength: 100
        documentImage:
          type: string
          format: byte
          example: U3dhZ2dlciByb2Nrcw=
        driverId:
          type: integer
          format: integer
          example: 10
    DrivingAssessment:
      type: object
      required:
        - locations
        - vehicleType
        - babyTransport
        - petTransport
      properties:
        locations:
          type: array
          description: List of locations which defines the order of the ride
          items:
            $ref: "#/components/schemas/LocationsForRide"
        vehicleType:
          type: string
          example: STANDARDNO
        babyTransport:
          type: boolean
        petTransport:
          type: boolean
    RideCreation:
      type: object
      required:
        - locations
        - passengers
        - vehicleType
        - babyTransport
        - petTransport
      properties:
        locations:
          type: array
          description: List of locations which defines the order of the ride
          items:
            $ref: "#/components/schemas/LocationsForRide"
        passengers:
          type: array
          description: List of users which are attached to the ride
          items:
            $ref: "#/components/schemas/UserRef"
        vehicleType:
          type: string
          example: STANDARDNO
        babyTransport:
          type: boolean
        petTransport:
          type: boolean
    LocationsForRide:
      type: object
      properties:
        departure:
          $ref: "#/components/schemas/GeoCoordinate"
        destination:
          $ref: "#/components/schemas/GeoCoordinate"
    Ride:
      type: object
      properties:
        startTime:
          type: string
          format: date-time
          example: 2017-07-21T17:32:28Z
        endTime:
          type: string
          format: date-time
          example: 2017-07-21T17:45:14Z
        totalCost:
          type: number
          example: 1235.0
        driver:
          $ref: "#/components/schemas/UserRef"
        passengers:
          type: array
          items:
            $ref: "#/components/schemas/UserRef"
        estimatedTimeInMinutes:
          type: integer
          example: 5
        vehicleType:
          type: string
          example: STANDARDNO
        babyTransport:
          type: boolean
        petTransport:
          type: boolean
        locations:
          type: array
          items:
            $ref: "#/components/schemas/GeoCoordinate"
    Review:
      type: object
      properties:
        id:
          type: integer
          format: integer
          example: 10
        rating:
          type: integer
          format: integer
          example: 5
        comment:
          type: string
          example: Odlična vožnja
        ride:
          $ref: "#/components/schemas/UserRef"
        passenger:
          $ref: "#/components/schemas/UserRef"
    GeoCoordinate:
      type: object
      required:
        - latitude
        - longitude
      properties:
        address:
          type: string
          format: string
          example: Bulevar oslobodjenja 46
        latitude:
          type: number
          example: 45.267136
          minimum: -90
          maximum: 90
        longitude:
          type: number
          example: 19.833549
          minimum: -180
          maximum: 180
    Vehicle:
      type: object
      required:
        - vehicleType
        - model
        - licenseNumber
        - passengerSeats
      properties:
        vehicleType:
          type: string
          example: STANDARDNO
        model:
          type: string
          example: VW Golf 2
          maxLength: 100
        licenseNumber:
          type: string
          example: NS 123-AB
          maxLength: 20
        currentLocation:
          $ref: "#/components/schemas/GeoCoordinate"
        passengerSeats:
          type: integer
          format: integer
          example: 4
          minimum: 1
          maximum: 20
        babyTransport:
          type: boolean
        petTransport:
          type: boolean
    WorkingHour:
      type: object
      required:
        - start
      properties:
        id:
          type: integer
          format: integer
          example: 10
        start:
          type: string
          format: date-time
        end:
          type: string
          format: date-time
    PanicCreate:
      type: object
      required:
        - reason
      properties:
        reason:
          type: string
          example: Driver is constantly listeting to bad music.
          maxLength: 500
    PanicDetails:
      type: object
      properties:
        id:
          type: integer
          format: integer
          example: 10
        userId:
          type: integer
          format: integer
          example: 123
        rideId:
          type: integer
          format: integer
          example: 123
        time:
          type: string
          format: date-time
        reason:
          type: string
          example: Driver is drinking while he drives
    AcceptRide:
      type: object
      required:
        - time
      properties:
        time:
          type: string
          format: date-time
    RejectRide:
      type: object
      required:
        - time
        - reason
      properties:
        time:
          type: string
          format: date-time
        reason:
          type: string
          example: Passenger is an old customer and he behvaed really badly last time.
    Login:
      type: object
      required:
        - email
        - password
      properties:
        email:
          type: string
          format: email
          example: pera.peric@email.com
        password:
          type: string
          format: password
          example: sifra123
    Message:
      type: object
      required:
        - receiverId
        - message
        - type
        - rideId
      properties:
        receiverId:
          type: integer
          format: integer
          example: 123
        message:
          type: string
          example: The driver is going on a longer route on purpose
          maxLength: 500
        type:
          type: string
          example: RIDE
        rideId:
          type: integer
          format: integer
          example: 123
    Note:
      type: object
      required:
        - message
      properties:
        message:
          type: string
          example: The passenger has requested and after that aborted the ride
          maxLength: 500

  requestBodies:
    CreateUser:
      description: Contains informations about the user
      content:
        application/json:
          schema:
            allOf:
              - $ref: "#/components/schemas/User"
              - type: object
                required:
                  - name
                  - surname
                  - email
                  - address
                  - password
                properties:
                  password:
                    type: string
                    format: string
                    example: Pasword123

    Note:
      description: Contains informations about the Note
      content:
        application/json:
          schema:
            allOf:
              - $ref: "#/components/schemas/Note"

    UserDetails:
      content:
        application/json:
          schema:
            allOf:
              - type: object
                properties:
                  id:
                    type: integer
                    format: integer
                    example: 123
              - $ref: "#/components/schemas/User"

    RideCreation:
      description: Data required for rider creation by user
      content:
        application/json:
          schema:
            allOf:
              - $ref: "#/components/schemas/RideCreation"
    DriverDocument:
      description: Data about the document for the driver
      content:
        application/json:
          schema:
            allOf:
              - $ref: "#/components/schemas/DriverDocument"
    Vehicle:
      description: Contains the information about the vehicle.
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/Vehicle"
    WorkingHour:
      description: Contains the information about the working houts of the driver
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/WorkingHour"
    Ride:
      description: Contains the information about the ride
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/Ride"
    RideList:
      description: Lista vožnji.
      content:
        application/json:
          schema:
            type: array
            items:
              $ref: "#/components/schemas/Ride"
    PanicCreate:
      description: Creating panic report
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/PanicCreate"
    PanicCreateList:
      description: Panic reports overview
      content:
        application/json:
          schema:
            type: array
            items:
              $ref: "#/components/schemas/PanicDetails"
    AcceptRide:
      description: Informations about accepting the ride
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/AcceptRide"
    RejectRide:
      description: Informations about rejecting the ride
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/RejectRide"
    GeoCoordinate:
      description: Informations about location with latitude and longitude coordinates
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/GeoCoordinate"
    Login:
      description: User login credentials
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/Login"
    Message:
      description: Contains data about the message from one user to another
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/Message"
    MessageList:
      description: Contains list of data about the message from one user to another
      content:
        application/json:
          schema:
            type: array
            items:
              $ref: "#/components/schemas/Message"
